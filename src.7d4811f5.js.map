{"version":3,"sources":["index.js"],"names":["baseUrl","reqServer","url","method","data","options","headers","fetch","body","JSON","stringify","then","res","json","console","log","refs","listNode","document","querySelector","form","renderPostList","markup","map","post","id","title","text","author","join","innerHTML","editPost","e","target","nodeName","closest","dataset","elements","value","addEventListener","code","shiftKey","updateForm","reset"],"mappings":";;;AAqDA,aArDA,QAAA,oBAEA,MAAMA,EAAU,wBAEhB,SAASC,EAAUC,EAAKC,EAAS,MAAOC,EAAO,IACvCC,MAAAA,EAAU,CACdF,OAAAA,EACAG,QAAS,CACS,eAAA,oCAObC,MAHQ,QAAXJ,GAA+B,WAAXA,IACtBE,EAAQG,KAAOC,KAAKC,UAAUN,IAEzBG,MAAMP,EAAUE,EAAKG,GAASM,KAAKC,GAAOA,EAAIC,QAEvDZ,EAAU,UAAUU,KAAKP,GAAQU,QAAQC,IAAIX,IAE7C,MAAMY,EAAO,CACXC,SAAUC,SAASC,cAAc,cACjCC,KAAMF,SAASC,cAAc,iBAG/B,SAASE,IACPpB,EAAU,UAAUU,KAAKP,IACjBkB,MAAAA,EAASlB,EACZmB,IACCC,mBAAwBA,EAAKC,qBACvBD,EAAKE,0BACNF,EAAKG,6DAEAH,EAAKI,2BAEhBC,KAAK,IACRb,EAAKC,SAASa,UAAYR,IAO9B,SAASS,EAASC,GACZA,GAAsB,WAAtBA,EAAEC,OAAOC,SAAuB,OAEpCjC,EAAU,UADC+B,EAAEC,OAAOE,QAAQ,MAAMC,QAAQX,IAChBd,KAAKP,IAC7BY,EAAKI,KAAKiB,SAASV,KAAKW,MAAQlC,EAAKuB,KACrCX,EAAKI,KAAKiB,SAAST,OAAOU,MAAQlC,EAAKwB,OACvCZ,EAAKI,KAAKiB,SAASX,MAAMY,MAAQlC,EAAKsB,MACtCV,EAAKI,KAAKiB,SAASZ,GAAGa,MAAQlC,EAAKqB,KAVvCJ,IACAL,EAAKC,SAASsB,iBAAiB,QAASR,GAaxCf,EAAKI,KAAKmB,iBAAiB,UAAWP,IAChCA,GAAW,UAAXA,EAAEQ,MAAoBR,EAAES,SAAU,CACpCzB,EAAKI,KAAKiB,SACJjC,MAAAA,EAAO,CACXuB,KAAMX,EAAKI,KAAKiB,SAASV,KAAKW,MAC9BV,OAAQZ,EAAKI,KAAKiB,SAAST,OAAOU,MAClCZ,MAAOV,EAAKI,KAAKiB,SAASX,MAAMY,OAE5BI,EAAatC,IACjBY,EAAKI,KAAKuB,QACV3B,EAAKI,KAAKiB,SAASZ,GAAGa,MAAQ,GAC9BjB,KAEII,EAAKT,EAAKI,KAAKiB,SAASZ,GAAGa,MAEtB,KAAPb,EACFxB,EAAU,SAAU,OAAQG,GAAMO,KAAK+B,GAEvCzC,YAAoBwB,IAAM,QAASrB,GAAMO,KAAK+B","file":"src.7d4811f5.js","sourceRoot":"../src","sourcesContent":["import './sass/main.scss';\n\nconst baseUrl = 'http://localhost:3000';\n\nfunction reqServer(url, method = 'GET', data = {}) {\n  const options = {\n    method,\n    headers: {\n      'Content-Type': 'application/json; charset=UTF-8',\n    },\n  };\n\n  if (method !== 'GET' && method !== 'DELETE') {\n    options.body = JSON.stringify(data);\n  }\n  return fetch(baseUrl + url, options).then(res => res.json());\n}\nreqServer('/posts').then(data => console.log(data));\n\nconst refs = {\n  listNode: document.querySelector('.post-list'),\n  form: document.querySelector('#create-post'),\n};\n\nfunction renderPostList() {\n  reqServer('/posts').then(data => {\n    const markup = data\n      .map(\n        post => `<li data-id=\"${post.id}\">\n        <h3>${post.title}</h3>\n        <p>${post.text}</p>\n        <button>EDIT</button> \n        <small> ${post.author}</small></p></li>`,\n      )\n      .join('');\n    refs.listNode.innerHTML = markup;\n  });\n}\n\nrenderPostList();\nrefs.listNode.addEventListener('click', editPost);\n\nfunction editPost(e) {\n  if (e.target.nodeName !== 'BUTTON') return;\n  const id = e.target.closest('li').dataset.id;\n  reqServer('/posts/' + id).then(data => {\n    refs.form.elements.text.value = data.text;\n    refs.form.elements.author.value = data.author;\n    refs.form.elements.title.value = data.title;\n    refs.form.elements.id.value = data.id;\n  });\n}\n\nrefs.form.addEventListener('keydown', e => {\n  if (e.code === 'Enter' && e.shiftKey) {\n    refs.form.elements;\n    const data = {\n      text: refs.form.elements.text.value,\n      author: refs.form.elements.author.value,\n      title: refs.form.elements.title.value,\n    };\n    const updateForm = data => {\n      refs.form.reset();\n      refs.form.elements.id.value = '';\n      renderPostList();\n    };\n    const id = refs.form.elements.id.value;\n\n    if (id === '') {\n      reqServer('/posts', 'POST', data).then(updateForm);\n    } else {\n      reqServer(`/posts/${id}`, 'PATCH', data).then(updateForm);\n    }\n  }\n});\n"]}